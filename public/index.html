<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Lichtara Write</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --blue-deep: #0A1A2F;
      --gold: #D4AF37;
      --silver: #C9D2D9;
      --offwhite: #F5F6F7;
      --black-cosmic: #000814;
    }

    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background: var(--blue-deep);
      color: var(--offwhite);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .app {
      max-width: 720px;
      width: 100%;
      padding: 48px 40px;
    }

    h1 {
      font-family: "Cormorant Garamond", serif;
      font-size: 42px;
      letter-spacing: 0.04em;
      color: var(--gold);
      text-align: center;
      margin-bottom: 6px;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      color: var(--silver);
      margin-bottom: 36px;
    }

    textarea {
      width: 100%;
      background: transparent;
      border: 1px solid var(--silver);
      border-radius: 6px;
      padding: 14px;
      font-size: 15px;
      color: var(--offwhite);
      resize: vertical;
      outline: none;
    }

    textarea::placeholder {
      color: var(--silver);
    }

    button {
      margin-top: 16px;
      background: transparent;
      border: 1px solid var(--gold);
      color: var(--gold);
      padding: 10px 22px;
      font-size: 13px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      cursor: pointer;
    }

    button:hover {
      background: var(--gold);
      color: var(--blue-deep);
    }

    pre {
      margin-top: 28px;
      color: var(--offwhite);
      font-size: 15px;
      line-height: 1.6;
      white-space: pre-wrap;
    }
  </style>
</head>

<body>
  <div class="app">
    <h1>Lichtara Write</h1>
    <div class="subtitle">
      LICHTARA Companion — Espaço de Coautoria Consciente
    </div>

<input id="title" placeholder="Título desta sessão (opcional)"
       style="width:100%;margin-bottom:14px;padding:10px;background:transparent;border:1px solid #C9D2D9;color:#F5F6F7;border-radius:6px;" />

<textarea id="msg" rows="6"
  placeholder="Escreva aqui o que deseja escutar com presença..."></textarea>

<button onclick="startSession()">Abrir sessão</button>
<button onclick="send()">Respirar com o Campo</button>

<pre id="out"></pre>

<h3 style="margin-top:40px;color:#D4AF37;">Sessões realizadas</h3>
<ul id="sessions" style="color:#C9D2D9;"></ul>

    <button onclick="send()">Respirar com o Campo</button>

    <pre id="out"></pre>
  </div>

  <script>
    async function send() {
      const message = document.getElementById("msg").value;

      const res = await fetch("/api/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message })
      });

      const data = await res.json();
      document.getElementById("out").innerText = data.reply;
    }
    async function startSession() {
  const title = document.getElementById("title").value || "Sem título";

  await fetch("/api/session/start", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ title })
  });

  document.getElementById("out").innerText =
    "Sessão aberta: " + title + "\nRespire. Escreva quando sentir.";

  loadSessions();
}

async function loadSessions() {
  const res = await fetch("/api/sessions");
  const data = await res.json();

  const ul = document.getElementById("sessions");
  ul.innerHTML = "";

  data.forEach(s => {
    const li = document.createElement("li");
    li.innerText = `${new Date(s.at).toLocaleString()} — ${s.title}`;
    ul.appendChild(li);
  });
}

loadSessions();

  </script>
</body>
</html>
